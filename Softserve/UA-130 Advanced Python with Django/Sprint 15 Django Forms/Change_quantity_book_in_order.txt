–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω, —Ç–≤–æ–π –∫–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å —Ç–µ–∫—É—â–µ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π: –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –≤ `Order`, –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ –≤ `book.count` —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É. –¢–∞–∫ —á—Ç–æ **–≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ**, –Ω–æ —Ç—ã —Ö–æ—á–µ—à—å —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: –¥–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±—Ä–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤, –∏ —á—Ç–æ–±—ã –æ–Ω–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –∑–∞–∫–∞–∑–∞.

–î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º—Å—è –ø–æ —à–∞–≥–∞–º ‚Äî –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –Ω–∞–¥—ë–∂–Ω–æ.

---

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å:

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç **–æ–¥–Ω—É –∫–Ω–∏–≥—É** –∏ –æ—Ñ–æ—Ä–º–ª—è–µ—Ç **–æ–¥–∏–Ω –∑–∞–∫–∞–∑ –Ω–∞ 1 —ç–∫–∑–µ–º–ø–ª—è—Ä**
- `book.count -= 1` ‚Äî –≤–µ—Ä–Ω–æ
- –ó–∞–∫–∞–∑ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è ‚Äî —Ö–æ—Ä–æ—à–æ

---

### üéØ –ß—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –¥–æ–±–∞–≤–∏—Ç—å:

- –ü–æ–ª–µ ‚Äú–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤‚Äù –≤ —Ñ–æ—Ä–º–µ
- –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å—Ç—å –ª–∏ —Å—Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–Ω–∏–≥
- –°–ø–∏—Å–∞–Ω–∏–µ `count` –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- –ò –≤–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–∏ ‚Äî –≤–æ–∑–≤—Ä–∞—Ç –∫–Ω–∏–≥ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –∑–∞–∫–∞–∑–∞

---

### üìå –®–∞–≥ 1: –î–æ–±–∞–≤–∏–º –ø–æ–ª–µ ‚Äú–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ‚Äù –≤ HTML

–í `create_order.html` –ø–æ–¥ `<select>`:

```html
<label for="quantity">Quantity:</label>
<input type="number" name="quantity" id="quantity" min="1" value="1">
```

---

### üß† –®–∞–≥ 2: –ò–∑–º–µ–Ω–∏–º view

–í–Ω—É—Ç—Ä–∏ `create_order_view` –¥–æ–±–∞–≤–∏–º –æ–±—Ä–∞–±–æ—Ç–∫—É `quantity`:

```python
from django.utils import timezone
from datetime import timedelta

@login_required
def create_order_view(request):
    books = Book.objects.all()
    error = None

    if request.method == 'POST':
        book_id = request.POST.get('book')
        quantity = int(request.POST.get('quantity', 1))

        try:
            book = Book.objects.get(id=book_id)
        except Book.DoesNotExist:
            error = "Book not found."
        else:
            if quantity < 1:
                error = "Quantity must be at least 1."
            elif book.count < quantity:
                error = f"Only {book.count} copies available."
            else:
                plated_end_at = timezone.now() + timedelta(weeks=2)

                for _ in range(quantity):
                    order = Order.create(user=request.user, book=book, plated_end_at=plated_end_at)

                book.count -= quantity
                book.save()
                return redirect('my_orders')

    return render(request, 'user/create_order.html', {
        'books': books,
        'error': error
    })
```

üîç –ó–¥–µ—Å—å:
- –ú—ã –ø–æ–ª—É—á–∞–µ–º `quantity` –∏–∑ —Ñ–æ—Ä–º—ã
- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ–Ω–æ ‚â• 1
- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤ –Ω–∞–ª–∏—á–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–Ω–∏–≥
- –°–æ–∑–¥–∞—ë–º **–Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤** ‚Äî –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–∞–∂–¥—É—é –∫–Ω–∏–≥—É
- –û–±–Ω–æ–≤–ª—è–µ–º `book.count` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ

---

### ‚ùó –í–∞—Ä–∏–∞–Ω—Ç: —Å–æ–∑–¥–∞—Ç—å –æ–¥–∏–Ω –∑–∞–∫–∞–∑ –∏ –≤ –Ω—ë–º —É–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ

–ï—Å–ª–∏ –≤ –º–æ–¥–µ–ª–∏ `Order` –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã **–æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∞–ª–∞ `quantity`**, —Ç–æ–≥–¥–∞:
- –¥–æ–±–∞–≤—å –ø–æ–ª–µ `quantity = models.PositiveIntegerField(default=1)` –≤ `Order`
- –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∏ `Order.create(...)` –∏ `__str__()` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —ç—Ç–æ–≥–æ –ø–æ–ª—è
- –≤ view –≤—ã–∑–æ–≤–∏ `Order.create(..., quantity=quantity)`
- —Å–ø–∏—Å—ã–≤–∞–π `book.count -= quantity`

–≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å ‚Äî –Ω–æ —Ç–æ–≥–¥–∞ –ø—Ä–∏–¥—ë—Ç—Å—è **–ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å –ª–æ–≥–∏–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–Ω–∏–≥–∏**, —Ç–∞–∫ –∫–∞–∫ –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å = –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤.

---

### üìå –ê –∫–∞–∫ –ø–æ—Ç–æ–º ‚Äú–≤–µ—Ä–Ω—É—Ç—å‚Äù –∫–Ω–∏–≥–∏?

–ï—Å–ª–∏ —Ç—ã —Å–æ–∑–¥–∞—ë—à—å –æ–¥–∏–Ω –∑–∞–∫–∞–∑ –Ω–∞ 3 –∫–Ω–∏–≥–∏, —Ç–æ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ:
- –ª–∏–±–æ –≤—ã—Å—Ç–∞–≤–ª—è–µ—à—å `order.end_at = now`, –∏ `book.count += order.quantity`
- –ª–∏–±–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤–æ–∑–≤—Ä–∞—Ç–µ ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—à—å, —Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –≤–µ—Ä–Ω—É–ª–∏ (–∏ —ç—Ç–æ –µ—â—ë –æ–¥–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, `returned_quantity`)

–ï—Å–ª–∏ –ø–æ–∫–∞ –∑–∞–¥–∞—á–∞ –ø—Ä–æ—Å—Ç–∞—è ‚Äî **–æ—Å—Ç–∞–≤—å 1 –∑–∞–∫–∞–∑ = 1 –∫–Ω–∏–≥–∞**, –∏ –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–≤–∞–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π. –≠—Ç–æ –Ω–∞–¥—ë–∂–Ω–µ–µ –∏ –≥–∏–±—á–µ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ.
