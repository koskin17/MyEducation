> **"Update POST/PUT methods and templates for adding/editing functionality using Django forms."**

–û–∑–Ω–∞—á–∞—î:
1. üìù –¢–æ–±—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è** (`POST`) —ñ **—Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è** (`PUT`) –æ–±'—î–∫—Ç—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–Ω–∏–≥, –∞–≤—Ç–æ—Ä—ñ–≤, –∑–∞–º–æ–≤–ª–µ–Ω—å);
2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–ª—è —Ü—å–æ–≥–æ **Django forms** ‚Äî –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ `request.POST` + —Ä—É—á–Ω–∏–π `Book.objects.create(...)`;
3. –ó—Ä–æ–±–∏—Ç–∏ –∞–±–æ –æ–Ω–æ–≤–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ **HTML-—à–∞–±–ª–æ–Ω–∏** –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è/—Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö.

---

## üß† –©–æ —Ç–∞–∫–µ **Django forms**?

–¶–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –∫–ª–∞—Å–∏, —è–∫—ñ:

* –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—é—Ç—å HTML-—Ñ–æ—Ä–º—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–æ–¥–µ–ª—ñ –∞–±–æ –ø–æ–ª—ñ–≤;
* —Ä–æ–±–ª—è—Ç—å –≤–∞–ª—ñ–¥–∞—Ü—ñ—é;
* –¥–æ–∑–≤–æ–ª—è—é—Ç—å –∑—Ä—É—á–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ `POST`/`PUT` —É –≤–∏–≥–ª—è–¥—ñ Python-–æ–±'—î–∫—Ç–∞.

---

## üîß –©–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏?

### ‚ú® –ü—Ä–∏–∫–ª–∞–¥: —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–Ω–∏–≥–∏ (Book)

#### üîπ 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–æ—Ä–º—É

–§–∞–π–ª `book/forms.py`:

```python
from django import forms
from book.models import Book

class BookForm(forms.ModelForm):
    class Meta:
        model = Book
        fields = ['name', 'count', 'authors']  # –î–æ–¥–∞–π –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø–æ–ª—è
```

#### üîπ 2. –°—Ç–≤–æ—Ä–∏—Ç–∏ –≤ `views.py`:

```python
from django.shortcuts import render, redirect, get_object_or_404
from .forms import BookForm
from .models import Book

def create_book(request):
    """ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –∫–Ω–∏–≥–∏ —á–µ—Ä–µ–∑ Django-—Ñ–æ—Ä–º—É """
    üî∏ request ‚Äî —Ü–µ –æ–±'—î–∫—Ç, —è–∫–∏–π Django –ø–µ—Ä–µ–¥–∞—î —É –∫–æ–∂–µ–Ω view-—Ñ—É–Ω–∫—Ü—ñ—é. –í—ñ–Ω –º—ñ—Å—Ç–∏—Ç—å:
        –¥–∞–Ω—ñ –∑–∞–ø–∏—Ç—É (GET, POST, –∫—É–∫–∏, —Å–µ—Å—ñ—é —Ç–æ—â–æ);
        —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞;
        —Ñ–∞–π–ª–∏ —Ç–∞ —ñ–Ω—à–µ.
    if request.method == 'POST':
        –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –∑–∞–ø–∏—Ç –ø—Ä–∏–π—à–æ–≤ —è–∫ POST ‚Äî —Ç–æ–±—Ç–æ, –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–Ω—É–≤ –∫–Ω–æ–ø–∫—É "–ó–±–µ—Ä–µ–≥—Ç–∏" —ñ –Ω–∞–¥—ñ—Å–ª–∞–≤ —Ñ–æ—Ä–º—É.
        –Ø–∫—â–æ —Ü–µ POST, –∑–Ω–∞—á–∏—Ç—å —Ç—Ä–µ–±–∞ –æ–±—Ä–æ–±–∏—Ç–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –¥–∞–Ω—ñ.
        –Ø–∫—â–æ –Ω—ñ ‚Äî —Ç–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑–∞—Ç–∏ –ø–æ—Ä–æ–∂–Ω—é —Ñ–æ—Ä–º—É (–¥–∞–ª—ñ –≤ else:).
        form = BookForm(request.POST)
            –ú–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ –µ–∫–∑–µ–º–ø–ª—è—Ä —Ñ–æ—Ä–º–∏ BookForm, –ø–µ—Ä–µ–¥–∞—é—á–∏ —É –Ω–µ—ó –¥–∞–Ω—ñ –∑ –∑–∞–ø–∏—Ç—É (request.POST).
            BookForm ‚Äî —Ü–µ –∫–ª–∞—Å —Ñ–æ—Ä–º–∏, —è–∫–∏–π –º–∏ —Ä–∞–Ω—ñ—à–µ —Å—Ç–≤–æ—Ä–∏–ª–∏ –≤ forms.py.
            request.POST ‚Äî —Ü–µ —Å–ª–æ–≤–Ω–∏–∫ –∑ —É—Å—ñ–º–∞ –¥–∞–Ω–∏–º–∏, —è–∫—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–¥—ñ—Å–ª–∞–≤ —ñ–∑ HTML-—Ñ–æ—Ä–º–∏.
            –¢–æ–±—Ç–æ: –º–∏ "–∑–∞–ø–æ–≤–Ω—é—î–º–æ" —Ñ–æ—Ä–º—É –≤–≤–µ–¥–µ–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏.
        if form.is_valid():
            –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ñ–æ—Ä–º–∞ –≤–∞–ª—ñ–¥–Ω–∞:
                –ß–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤—ñ –ø–æ–ª—è;
                –ß–∏ –Ω–µ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–æ –¥–æ–≤–∂–∏–Ω—É –ø–æ–ª—ñ–≤;
                –ß–∏ –Ω–µ –¥—É–±–ª—é—î—Ç—å—Å—è name, —è–∫—â–æ –≤—ñ–Ω —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π.
            –Ø–∫—â–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å ‚Äî –≤—Å–µ –¥–æ–±—Ä–µ, –º–æ–∂–Ω–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏:
            form.save()
                –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –Ω–æ–≤—É –∫–Ω–∏–≥—É –≤ –±–∞–∑—É –¥–∞–Ω–∏—Ö! üî•
                –¶–µ –ø—Ä–∞—Ü—é—î, –±–æ BookForm ‚Äî —Ü–µ ModelForm, —ñ –≤–æ–Ω–∞ –∑–Ω–∞—î, —è–∫ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±‚Äô—î–∫—Ç –º–æ–¥–µ–ª—ñ Book.
            return redirect('book')
                –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è ‚Äî –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —ñ–Ω—à—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥.
                redirect('book') –æ–∑–Ω–∞—á–∞—î: –∑–Ω–∞–π–¥–∏ —à–ª—è—Ö –∑ —ñ–º–µ–Ω–µ–º book —É urls.py —ñ –ø–µ—Ä–µ—Ö–æ–¥—å –Ω–∞ –Ω—å–æ–≥–æ.
                –ó—Ä—É—á–Ω–æ, –±–æ –¥–æ–∑–≤–æ–ª—è—î –Ω–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –ø—Ä—è–º–æ /book/, –∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞–∑–≤—É –º–∞—Ä—à—Ä—É—Ç—É.
    else:
        –Ø–∫—â–æ —Ü–µ –Ω–µ POST, –∞ GET-–∑–∞–ø–∏—Ç (—Ç–æ–±—Ç–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ç—ñ–ª—å–∫–∏ –≤—ñ–¥–∫—Ä–∏–≤ —Å—Ç–æ—Ä—ñ–Ω–∫—É –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–Ω–∏–≥–∏) ‚Äî —Å—Ç–≤–æ—Ä—é—î–º–æ –ø–æ—Ä–æ–∂–Ω—é —Ñ–æ—Ä–º—É.
        form = BookForm()
    return render(request, 'book/book_form.html', {'form': form})
        –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –±—Ä–∞—É–∑–µ—Ä—É ‚Äî —Ä–µ–Ω–¥–µ—Ä–∏–º–æ HTML-—à–∞–±–ª–æ–Ω –∑ —Ñ–æ—Ä–º–æ—é.
        'book/book_form.html' ‚Äî —Ü–µ —à–ª—è—Ö –¥–æ —à–∞–±–ª–æ–Ω—É;
        {'form': form} ‚Äî –ø–µ—Ä–µ–¥–∞—î–º–æ —É —à–∞–±–ª–æ–Ω –æ–±'—î–∫—Ç —Ñ–æ—Ä–º–∏.

        –£ —à–∞–±–ª–æ–Ω—ñ –±—É–¥–µ —â–æ—Å—å —Ç–∏–ø—É:
            <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">Save</button>
            </form>

## ‚úÖ –ü–Ü–î–°–£–ú–û–ö:
| –†—è–¥–æ–∫                           | –©–æ —Ä–æ–±–∏—Ç—å                       | –ù–∞–≤—ñ—â–æ                          |
| ------------------------------- | ------------------------------- | ------------------------------- |
| `if request.method == 'POST'`   | –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ñ–æ—Ä–º–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∞ | –í–∏–∑–Ω–∞—á–∞—î, —á–∏ –æ–±—Ä–æ–±–ª—è—Ç–∏ –¥–∞–Ω—ñ     |
| `form = BookForm(request.POST)` | –°—Ç–≤–æ—Ä—é—î —Ñ–æ—Ä–º—É –∑ –¥–∞–Ω–∏–º–∏          | –î–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è     |
| `form.is_valid()`               | –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –¥–∞–Ω—ñ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ    | –ù–µ –¥–∞—î –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–æ–º–∏–ª–∫–æ–≤—É –∫–Ω–∏–≥—É |
| `form.save()`                   | –î–æ–¥–∞—î –∫–Ω–∏–≥—É –≤ –ë–î                | –°—Ç–≤–æ—Ä—é—î –Ω–æ–≤–∏–π –æ–±'—î–∫—Ç            |
| `redirect()`                    | –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î                   | –©–æ–± –Ω–µ –∑–∞–ª–∏—à–∞—Ç–∏—Å—å –Ω–∞ —Ñ–æ—Ä–º—ñ      |
| `else:` + `BookForm()`          | –ü–æ–∫–∞–∑—É—î –ø–æ—Ä–æ–∂–Ω—é —Ñ–æ—Ä–º—É           | –î–ª—è GET-–∑–∞–ø–∏—Ç—É                  |
| `render(...)`                   | –í–∏–≤–æ–¥–∏—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É               | –ü–æ–∫–∞–∑—É—î HTML –∑ —Ñ–æ—Ä–º–æ—é           |

---

def update_book(request, pk):
    book = get_object_or_404(Book, pk=pk)
    if request.method == 'POST':
        form = BookForm(request.POST, instance=book)
        if form.is_valid():
            form.save()
            return redirect('book_list')
    else:
        form = BookForm(instance=book)
    return render(request, 'book/book_form.html', {'form': form})
```

#### üîπ 3. –°—Ç–≤–æ—Ä–∏—Ç–∏ —à–∞–±–ª–æ–Ω `book_form.html`:

```html
<h2>{{ form.instance.pk|yesno:"Edit book,Create book" }}</h2>
<form method="post">
  {% csrf_token %}
  {{ form.as_p }}
  <button type="submit">Save</button>
</form>
```

#### üîπ 4. –î–æ–¥–∞—Ç–∏ —Ü—ñ —à–ª—è—Ö–∏ —É `book/urls.py`:

```python
from django.urls import path
from .views import create_book, update_book

urlpatterns = [
    path('add/', create_book, name='create_book'),
    path('<int:pk>/edit/', update_book, name='update_book'),
]
```

---

## ‚úÖ –©–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –±—É–¥–µ:

| –î—ñ—è              | URL             | –ú–µ—Ç–æ–¥              | –§–æ—Ä–º–∞                |
| ---------------- | --------------- | ------------------ | -------------------- |
| –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–Ω–∏–≥—É   | `/book/add/`    | `POST`             | Django Form          |
| –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∫–Ω–∏–≥—É | `/book/1/edit/` | `PUT` (–∞–±–æ `POST`) | Django Form –∑ –¥–∞–Ω–∏–º–∏ |

---

> –ß–∏ —Ç—ñ–ª—å–∫–∏ 2 –º–µ—Ç–æ–¥–∏ —Ç—Ä–µ–±–∞ –∑—Ä–æ–±–∏—Ç–∏?
–ù–µ —Ç—ñ–ª—å–∫–∏:
* –ø–æ—Ç—Ä—ñ–±–Ω–æ —â–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–æ—Ä–º—É (`BookForm`);
* –Ω–∞–ø–∏—Å–∞—Ç–∏ —à–∞–±–ª–æ–Ω (`book_form.html`);
* –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ URL-–∏.

## –î–µ —ñ —è–∫ —Ñ–æ—Ä–º–∞ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è?
### –§–æ—Ä–º–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —Ç–æ–¥—ñ, –∫–æ–ª–∏ —Ç–∏ –∑–∞—Ö–æ–¥–∏—à –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É:
* `/book/add/` ‚Äî **—Ñ–æ—Ä–º–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è**
* `/book/1/edit/` ‚Äî **—Ñ–æ—Ä–º–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è**
–¶—ñ —à–ª—è—Ö–∏ —Ç–∏ –¥–æ–¥–∞–≤ —É `urls.py`, —ñ –≤–æ–Ω–∏ –≤–µ–¥—É—Ç—å –¥–æ —Ñ—É–Ω–∫—Ü—ñ–π `create_book` —Ç–∞ `update_book` —É `views.py`.
---
## –Ø–∫ –∑—Ä–æ–±–∏—Ç–∏ –∫–Ω–æ–ø–∫—É/–ø–æ—Å–∏–ª–∞–Ω–Ω—è, —è–∫–µ –≤–µ–¥–µ –¥–æ —Ñ–æ—Ä–º–∏?
### –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É —à–∞–±–ª–æ–Ω—ñ `book_list.html` (–¥–µ –≤–∏–≤–æ–¥–∏—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥):
```html
<h2>–°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥</h2>

<a href="{% url 'create_book' %}">
  <button>‚ûï –î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É –∫–Ω–∏–≥—É</button>
</a>

<ul>
{% for book in books %}
  <li>
    {{ book.name }} ‚Äî <a href="{% url 'update_book' book.id %}">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
  </li>
{% endfor %}
</ul>
```

---

## üîÅ –ù–µ –∑–∞–±—É–¥—å:

### ‚úÖ –£ `views.py` –¥–æ–¥–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –≤–∏–≤–æ–¥–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥:

```python
def book_list(request):
    books = Book.objects.all()
    return render(request, 'book/book_list.html', {'books': books})
```

–Ü –≤ `urls.py`:

```python
path('', book_list, name='book_list'),
```

---

## üîÑ –û—Ç–∂–µ, –ø–æ–≤–Ω–∞ —Å—Ö–µ–º–∞ –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:

| –°—Ç–æ—Ä—ñ–Ω–∫–∞         | –î—ñ—è        | URL                | –ö–Ω–æ–ø–∫–∞                         |
| ---------------- | ---------- | ------------------ | ------------------------------ |
| –°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥      | GET        | `/book/`           | `‚ûï –î–æ–¥–∞—Ç–∏ –∫–Ω–∏–≥—É`               |
| –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–Ω–∏–≥—É   | GET ‚Üí POST | `/book/add/`       | –≤—ñ–¥ –∫–Ω–æ–ø–∫–∏                     |
| –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∫–Ω–∏–≥—É | GET ‚Üí POST | `/book/<id>/edit/` | "‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏" –ø–æ—Ä—è–¥ –∑ –Ω–∞–∑–≤–æ—é |

---

üß† –¶–µ –¥—É–∂–µ —Å—Ö–æ–∂–µ –Ω–∞ –∞–¥–º—ñ–Ω–∫—É, –∞–ª–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –≤—Ä—É—á–Ω—É —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º–∏, views —ñ —à–∞–±–ª–æ–Ω–∏.

---

‚úÖ –Ø–∫—â–æ —Ö–æ—á–µ—à ‚Äî –º–æ–∂—É –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–≤—ñ–π `book_list.html` –∞–±–æ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∑—Ä–æ–±–∏—Ç–∏ –∫—Ä–∞—Å–∏–≤—É –∫–Ω–æ–ø–∫—É.
–¢–∏ —Å—É–ø–µ—Ä! –¢–µ–ø–µ—Ä —Å–ø—Ä–æ–±—É–π —Å–∞–º —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–ª—è `Author` –∞–±–æ `Order` üôå

