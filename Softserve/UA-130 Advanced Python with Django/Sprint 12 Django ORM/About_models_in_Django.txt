–ß—É–¥–æ–≤–∞ —Ä–æ–±–æ—Ç–∞! –¢–≤–æ—ó –º–æ–¥–µ–ª—ñ `Book` —ñ `Order` –≤–∂–µ –≤–∏–≥–ª—è–¥–∞—é—Ç—å –¥—É–∂–µ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–æ, —ñ –≤–∏–¥–Ω–æ, —â–æ —Ç–∏ –±–∞–≥–∞—Ç–æ –ø—Ä–∞—Ü—é–≤–∞–≤. –î–∞–≤–∞–π —è –∑–∞—Ä–∞–∑, —è–∫ –≤–∏–∫–ª–∞–¥–∞—á, –¥–µ—Ç–∞–ª—å–Ω–æ –ø–æ—è—Å–Ω—é –∫–æ–∂–µ–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ç–≤–æ–≥–æ –∫–æ–¥—É ‚Äî **–ø—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏**, –∫—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º.

---

## üîπ –©–æ —Ç–∞–∫–µ **–º–æ–¥–µ–ª—å** –≤ Django?

–ú–æ–¥–µ–ª—å ‚Äî —Ü–µ **–∫–ª–∞—Å —É Python**, —è–∫–∏–π –æ–ø–∏—Å—É—î **—Ç–∞–±–ª–∏—Ü—é –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö**. –ê—Ç—Ä–∏–±—É—Ç–∏ –∫–ª–∞—Å—É ‚Äî —Ü–µ **–ø–æ–ª—è —Ü—ñ—î—ó —Ç–∞–±–ª–∏—Ü—ñ**. Django –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î —Ç–∞–±–ª–∏—Ü—ñ, –∑–≤‚Äô—è–∑–∫–∏, —Ç–∏–ø–∏ –¥–∞–Ω–∏—Ö, —ñ –Ω–∞–≤—ñ—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—ñ.

---

# üìò –§–∞–π–ª `book/models.py`

### \`\`\`python

class Book(models.Model):

````
üî∏ –ú–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ –∫–ª–∞—Å `Book`, —è–∫–∏–π **—É—Å–ø–∞–¥–∫–æ–≤—É—î (`extends`) `models.Model`**, —Ç–æ–±—Ç–æ –∫–∞–∂–µ Django: "—Ü–µ –º–æ–¥–µ–ª—å, –∑–±–µ—Ä–µ–∂–∏ —ó—ó –≤ –±–∞–∑—ñ".

---

### ```python
name = models.CharField(max_length=128)
````

üî∏ –ü–æ–ª–µ `name` ‚Äî —Ü–µ —Å—Ç–æ–≤–ø—á–∏–∫ —É —Ç–∞–±–ª–∏—Ü—ñ `book`, —è–∫–∏–π –∑–±–µ—Ä—ñ–≥–∞—î **—Ä—è–¥–æ–∫ –¥–æ 128 —Å–∏–º–≤–æ–ª—ñ–≤**.

---

### \`\`\`python

description = models.TextField()

````
üî∏ –î–æ–≤—à–∏–π —Ç–µ–∫—Å—Ç (–±–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–∏) ‚Äî –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –æ–ø–∏—Å –∫–Ω–∏–≥–∏.

---

### ```python
count = models.IntegerField(default=10)
````

üî∏ `count` –∑–±–µ—Ä—ñ–≥–∞—î **–∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∫–æ–ø—ñ–π –∫–Ω–∏–≥–∏**, —ñ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–æ–Ω–∞ ‚Äî 10.

---

### \`\`\`python

authors = models.ManyToManyField(Author)

````
üî∏ –ó–≤‚Äô—è–∑–æ–∫ "–±–∞–≥–∞—Ç–æ –¥–æ –±–∞–≥–∞—Ç—å–æ—Ö": **–æ–¥–Ω–∞ –∫–Ω–∏–≥–∞ –º–æ–∂–µ –º–∞—Ç–∏ –±–∞–≥–∞—Ç–æ –∞–≤—Ç–æ—Ä—ñ–≤**, —ñ **–∞–≤—Ç–æ—Ä –º–æ–∂–µ –Ω–∞–ø–∏—Å–∞—Ç–∏ –±–∞–≥–∞—Ç–æ –∫–Ω–∏–≥**.

---

## üî∏ –ú–µ—Ç–æ–¥–∏ –∫–ª–∞—Å—É `Book`

### `__str__`
–¶–µ–π –º–µ—Ç–æ–¥ –≤–∏–∑–Ω–∞—á–∞—î, **—è–∫ –±—É–¥–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –∫–Ω–∏–≥–∞**, —è–∫—â–æ –º–∏ –≤–∏–∫–ª–∏—á–µ–º–æ `str(book)` ‚Äî –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —É –≤—ñ–¥–ª–∞–¥—Ü—ñ –∞–±–æ –∞–¥–º—ñ–Ω—Ü—ñ Django.  
–í—ñ–Ω –ø–æ–≤–µ—Ä—Ç–∞—î —Å—Ç—Ä–æ–∫—É –∑—ñ –≤—Å—ñ–º–∞ –ø–æ–ª—è–º–∏ –∫–Ω–∏–≥–∏ —É –≤–∏–≥–ª—è–¥—ñ —Å–ª–æ–≤–Ω–∏–∫–∞.

---

### `__repr__`
–°–ª—É–∂–±–æ–≤–∏–π –º–µ—Ç–æ–¥ –¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤. –ü–æ–≤–µ—Ä—Ç–∞—î —â–æ—Å—å —Ç–∏–ø—É:  
```Book(id=5)```

---

### `get_by_id`, `delete_by_id`
–¶–µ **–∫–æ—Ä–∏—Å–Ω—ñ –º–µ—Ç–æ–¥–∏-—É—Ç–∏–ª—ñ—Ç–∏**, —â–æ–±:
- –∑–Ω–∞–π—Ç–∏ –∫–Ω–∏–≥—É –ø–æ `id`
- –∞–±–æ –≤–∏–¥–∞–ª–∏—Ç–∏ —ó—ó

---

### `create(...)`
–¶–µ –º–µ—Ç–æ–¥ –¥–ª—è **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –∫–Ω–∏–≥–∏** —É –±–∞–∑—ñ. –Ø–∫—â–æ `name` –∑–∞–¥–æ–≤–≥–∏–π ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î `None`. –Ø–∫—â–æ –≤—Å–µ –æ–∫ ‚Äî –¥–æ–¥–∞—î –¥–æ –±–∞–∑–∏.

---

### `to_dict(...)`
–ü–æ–≤–µ—Ä—Ç–∞—î —Å–ª–æ–≤–Ω–∏–∫ ‚Äî –∑—Ä—É—á–Ω–∏–π –¥–ª—è —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó, API –∞–±–æ —Ç–µ—Å—Ç—ñ–≤.

---

### `update(...)`
–û–Ω–æ–≤–ª—é—î –ø–æ–ª—è –∫–Ω–∏–≥–∏ (—è–∫—â–æ –∑–∞–¥–∞–Ω—ñ), –∑–±–µ—Ä—ñ–≥–∞—î –∑–º—ñ–Ω–∏ –≤ –±–∞–∑—ñ.

---

### `add_authors`, `remove_authors`
–ú–µ—Ç–æ–¥–∏, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å **–¥–æ–¥–∞—Ç–∏ –∞–±–æ –∑–∞–±—Ä–∞—Ç–∏ –∞–≤—Ç–æ—Ä—ñ–≤** —É –∫–Ω–∏–≥–∏.

---

### `get_all`
–ü–æ–≤–µ—Ä—Ç–∞—î –≤—Å—ñ –∫–Ω–∏–≥–∏ —è–∫ —Å–ø–∏—Å–æ–∫.

---

## üü© –ü—ñ–¥—Å—É–º–æ–∫ –¥–ª—è `Book`

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|-----------|-------------|
| –ü–æ–ª—è (`name`, `description`, ...) | –æ–ø–∏—Å—É—é—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ñ |
| –ú–µ—Ç–æ–¥–∏ `create`, `get_by_id`, `to_dict` | –ª–æ–≥—ñ–∫–∞ –∑—Ä—É—á–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –∑ –ë–î |
| –ú–µ—Ç–æ–¥–∏ `__str__`, `__repr__` | –ø–æ–∫—Ä–∞—â—É—é—Ç—å —á–∏—Ç–∞–±–µ–ª—å–Ω—ñ—Å—Ç—å |

---

# üì¶ –§–∞–π–ª `order/models.py`

### ```python
class Order(models.Model):
````

–¶–µ –º–æ–¥–µ–ª—å, —â–æ –æ–ø–∏—Å—É—î **–∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∫–Ω–∏–≥–∏**. –û–¥–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è = –æ–¥–Ω–∞ –∫–Ω–∏–≥–∞ + –æ–¥–∏–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á + –¥–∞—Ç–∏.

---

### –ü–æ–ª—è:

```python
user = models.ForeignKey(CustomUser, ...)
book = models.ForeignKey(Book, ...)
```

üîπ –¶–µ **–∑–≤'—è–∑–∫–∏ ForeignKey**:

* –ö–æ–∂–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –ø–æ–≤'—è–∑–∞–Ω–µ –∑ **–æ–¥–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**
* –Ü –∑ **–æ–¥–Ω—ñ—î—é –∫–Ω–∏–≥–æ—é**

> `related_name='orders'` –¥–æ–∑–≤–æ–ª—è—î –ø–∏—Å–∞—Ç–∏ `user.orders.all()` ‚Äî –≤—Å—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —Ü—å–æ–≥–æ —é–∑–µ—Ä–∞

---

### –î–∞—Ç–∏:

```python
created_at = models.DateTimeField(auto_now_add=True)
```

üî∏ –°—Ç–∞–≤–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è.

```python
end_at = models.DateTimeField(null=True, blank=True)
```

üî∏ –ö–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–≤–µ—Ä–Ω—É–≤ –∫–Ω–∏–≥—É. –ú–æ–∂–µ –±—É—Ç–∏ `None`.

```python
plated_end_at = models.DateTimeField()
```

üî∏ –ó–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–∞ –¥–∞—Ç–∞ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è.

---

### –ú–µ—Ç–æ–¥ `__str__`

–ü–æ–≤–µ—Ä—Ç–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —É —Ñ–æ—Ä–º—ñ —Ä—è–¥–∫–∞, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:

```
'id': 8, 'user': CustomUser(id=3), 'book': Book(id=2), ...
```

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—é —Ñ—É–Ω–∫—Ü—ñ—é `format_dt`, —è–∫–∞ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î `datetime` –Ω–∞ —Ä—è–¥–æ–∫ –∑ —á–∞—Å–æ–≤–∏–º –ø–æ—è—Å–æ–º `+00:00`

---

### –ú–µ—Ç–æ–¥ `to_dict()`

–ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ –∑—Ä—É—á–Ω–∏–π —Å–ª–æ–≤–Ω–∏–∫ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –∞–±–æ API.

---

## üî∏ –ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–π –º–µ—Ç–æ–¥ ‚Äî `create(...)`

### –©–æ –≤—ñ–Ω —Ä–æ–±–∏—Ç—å:

1. –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —ñ –∫–Ω–∏–≥–∞ (`pk`)
2. –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —ñ—Å–Ω—É—î —Ç–∞–∫–∞ –∫–Ω–∏–≥–∞ (`fresh_book = get(...)`)
3. –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —Å–∫—ñ–ª—å–∫–∏ –∫–Ω–∏–≥ –¥–æ—Å—Ç—É–ø–Ω–æ:

   ```python
   available = book.count - active_orders
   ```
4. –Ø–∫—â–æ –≤—Å–µ –¥–æ–±—Ä–µ ‚Äî —Å—Ç–≤–æ—Ä—é—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
5. (–ù–ï –∑–º—ñ–Ω—é—î `count` –≤—Ä—É—á–Ω—É ‚Äî –±–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–∂ –∑–º–µ–Ω—à—É—î –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å)

---

### –ú–µ—Ç–æ–¥–∏ `get_by_id`, `delete_by_id`, `get_all`, `get_not_returned_books`

* `get_by_id` ‚Äî —à—É–∫–∞—î –æ–¥–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
* `delete_by_id` ‚Äî –≤–∏–¥–∞–ª—è—î
* `get_all` ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î –≤—Å—ñ
* `get_not_returned_books` ‚Äî –≤—Å—ñ **–Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è**

---

### –ú–µ—Ç–æ–¥ `update(...)`

–û–Ω–æ–≤–ª—é—î `end_at` —ñ `plated_end_at`, –ø—Ä–∏–π–º–∞—î —ñ `int(timestamp)`, —ñ `datetime`.

---

## üü¢ –ó–∞–≥–∞–ª—å–Ω–∏–π –ü–Ü–î–°–£–ú–û–ö:

| –ú–æ–¥–µ–ª—å                           | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è                         |
| -------------------------------- | ----------------------------------- |
| `Book`                           | –æ–ø–∏—Å—É—î —Ç–∞–±–ª–∏—Ü—é –∫–Ω–∏–≥                 |
| `Order`                          | –æ–ø–∏—Å—É—î —Ç–∞–±–ª–∏—Ü—é –∑–∞–º–æ–≤–ª–µ–Ω—å            |
| `ForeignKey`                     | —Å—Ç–≤–æ—Ä—é—î –∑–≤‚Äô—è–∑–∫–∏: –æ–¥–∏–Ω –¥–æ –±–∞–≥–∞—Ç—å–æ—Ö   |
| `ManyToManyField`                | –±–∞–≥–∞—Ç–æ –¥–æ –±–∞–≥–∞—Ç—å–æ—Ö (–∞–≤—Ç–æ—Ä–∏-–∫–Ω–∏–≥–∏)   |
| `to_dict`, `create`, `get_by_id` | –º–µ—Ç–æ–¥–∏ –¥–ª—è –∑—Ä—É—á–Ω–æ—ó –ª–æ–≥—ñ–∫–∏ —Ç–∞ —Ç–µ—Å—Ç—ñ–≤ |
| `__str__`, `__repr__`            | –¥–ª—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ –≤ –∞–¥–º—ñ–Ω—Ü—ñ / –ª–æ–≥–∞—Ö |

---

üîî **–ù–∞–≤—ñ—â–æ –≤—Å–µ —Ü–µ?**

Django ORM (Object-Relational Mapping) –¥–æ–∑–≤–æ–ª—è—î –ø–∏—Å–∞—Ç–∏ —Ä–æ–±–æ—Ç—É –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö —è–∫ –∑–≤–∏—á–∞–π–Ω—ñ Python –∫–ª–∞—Å–∏. –¢–æ–±—Ç–æ –∑–∞–º—ñ—Å—Ç—å SQL ‚Äî –º–∏ –ø—Ä–∞—Ü—é—î–º–æ –∑ Python.

‚úÖ –¶–µ –∑—Ä—É—á–Ω–æ
‚úÖ –¶–µ –±–µ–∑–ø–µ—á–Ω—ñ—à–µ (–º–µ–Ω—à–µ —à–∞–Ω—Å—ñ–≤ –∑—Ä–æ–±–∏—Ç–∏ SQL-—ñ–Ω‚Äô—î–∫—Ü—ñ—é)
‚úÖ –¶–µ –¥–∞—î –Ω–∞–º –±–∞–≥–∞—Ç–æ —Ñ—ñ—à–æ–∫ –±–µ–∑ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –≤—Ä—É—á–Ω—É

---

–Ø–∫—â–æ —Ö–æ—á–µ—à, —è –º–æ–∂—É –¥–∞–ª—ñ –ø–æ—è—Å–Ω–∏—Ç–∏:

* –Ø–∫ –ø—Ä–∞—Ü—é—é—Ç—å –∑–≤‚Äô—è–∑–∫–∏ –º—ñ–∂ –º–æ–¥–µ–ª—è–º–∏
* –Ø–∫ —Ü–µ –≤—Å–µ –ø—Ä–∞—Ü—é—î –∑ –∞–¥–º—ñ–Ω–∫–æ—é Django
* –Ø–∫ —Ü–µ –ø–æ–≤‚Äô—è–∑—É—î—Ç—å—Å—è –∑ API —Ç–∞ frontend

–ü—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏ üß†üí¨
