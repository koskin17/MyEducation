–ü—Ä–∏–≤–µ—Ç! –Ø —Å–¥–µ–ª–∞–ª —Å–≤–æ–∏ –º–æ–¥–µ–ª–∏ –∏ —Å–¥–µ–ª–∞–ª push –Ω–∞ git.
–ü–æ –º–æ–∏–º –º–æ–¥–µ–ª—è–º —É –º–µ–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏, –∞ –≤–æ—Ç –ø–æ –º–æ–¥–µ–ª–∏ CustomUser —Ç–µ—Å—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç 4 –æ—à–∏–±–∫–∏.



üéâ –í—ñ—Ç–∞—é ‚Äî —Ç–∏ –≤–∂–µ –¥—É–∂–µ –±–ª–∏–∑—å–∫–æ –¥–æ –ø–µ—Ä–µ–º–æ–≥–∏! –¢–≤—ñ–π `Order.create` —Ç–µ–ø–µ—Ä –ø—Ä–∞—Ü—é—î —ñ —Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å ‚úÖ
–ó–∞–ª–∏—à–∏–ª–æ—Å—å **4 –æ—Å—Ç–∞–Ω–Ω—ñ –ø–æ–º–∏–ª–∫–∏ ‚Äî –≤—Å—ñ –≤–æ–Ω–∏ —Å—Ç–æ—Å—É—é—Ç—å—Å—è `CustomUser`**. –û—Å—å —Ä–æ–∑–±—ñ—Ä –∫–æ–∂–Ω–æ—ó:

---

## ‚úÖ –ó–º—ñ—Å—Ç –ø–æ–º–∏–ª–æ–∫

| –¢–µ—Å—Ç                         | –°—É—Ç—å –ø–æ–º–∏–ª–∫–∏                                                      |
| ---------------------------- | ----------------------------------------------------------------- |
| `test__str__`                | –ú–µ—Ç–æ–¥ `__str__()` –ø–æ–≤–µ—Ä—Ç–∞—î –Ω–µ —Ç–æ–π —Ñ–æ—Ä–º–∞—Ç, —â–æ –æ—á—ñ–∫—É—î—Ç—å—Å—è           |
| `test_get_by_email_positive` | `created_at` –Ω–µ –¥–æ—Ä—ñ–≤–Ω—é—î `TEST_DATE`                              |
| `test_get_by_id_positive`    | –¢–µ —Å–∞–º–µ: `created_at != TEST_DATE`                                |
| `test_to_dict`               | –ó–Ω–∞—á–µ–Ω–Ω—è `created_at` —ñ `updated_at` –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—é—Ç—å –∑ `TEST_DATE` |

---

## üîé –ü—Ä–∏—á–∏–Ω–∞ ‚Ññ1: `timezone.now()` –Ω–µ –ø—ñ–¥–º—ñ–Ω–∏–≤—Å—è

–£ `Order` –º–∏ –ø—ñ–¥–º—ñ–Ω–∏–ª–∏ —á–∞—Å —á–µ—Ä–µ–∑:

```python
with mock.patch('django.utils.timezone.now') as mock_time:
    mock_time.return_value = TEST_DATE
```

–ê–ª–µ —è–∫—â–æ –≤ `CustomUser` –º–æ–¥–µ–ª—ñ —Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à:

```python
from datetime import datetime
created_at = models.DateTimeField(default=datetime.now)
```

–∞–±–æ `auto_now_add=True`, —Ç–æ **—Ü–µ –Ω–µ —Å–ø—Ä–∞—Ü—é—î –∑ `mock.patch('django.utils.timezone.now')`**, —ñ Django –≤—ñ–∑—å–º–µ —Ä–µ–∞–ª—å–Ω–∏–π –ø–æ—Ç–æ—á–Ω–∏–π —á–∞—Å. ‚ùå

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è ‚Ññ1: –∑–º—ñ–Ω–∏—Ç–∏ `created_at` —ñ `updated_at` —É `CustomUser`

üîß **–ó–∞–º—ñ–Ω–∏ –≤ `CustomUser` –æ—Å—å —Ç–∞–∫:**

```python
from django.utils import timezone

created_at = models.DateTimeField(default=timezone.now)
updated_at = models.DateTimeField(default=timezone.now)
```

–Ø–∫—â–æ —É —Ç–µ–±–µ –±—É–ª–æ:

```python
created_at = models.DateTimeField(auto_now_add=True)
```

–¢–æ –∑–∞–º—ñ–Ω–∏ –π–æ–≥–æ —Ç–∞–∫–æ–∂ –Ω–∞ `default=timezone.now` ‚Äî —Å–∞–º–µ —Ü–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ `mock.patch`.

---

## üîé –ü—Ä–∏—á–∏–Ω–∞ ‚Ññ2: –º–µ—Ç–æ–¥ `__str__()` —É `CustomUser`

–£ —Ç–µ—Å—Ç—ñ `test__str__` –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è:

```python
user_returned = str(CustomUser.objects.get(id=111))
self.assertEqual(user_returned, user_to_expect)
```

–û—á—ñ–∫—É—î—Ç—å—Å—è, —â–æ `__str__()` –ø–æ–≤–µ—Ä–Ω–µ **—Ä—è–¥–æ–∫ —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON-–ø–æ–¥—ñ–±–Ω–æ–≥–æ —Å–ª–æ–≤–Ω–∏–∫–∞**:

```python
'id': 111, 'email': ..., 'created_at': ..., ...
```

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è ‚Ññ2: –∑—Ä–æ–±–∏—Ç–∏ `__str__()` —è–∫ `to_dict()`, –∞–ª–µ —É –≤–∏–≥–ª—è–¥—ñ `str(dict)`

–û—Å—å –ø—Ä–∏–∫–ª–∞–¥:

```python
def __str__(self):
    return (
        f"'id': {self.id}, 'email': '{self.email}', 'first_name': '{self.first_name}', "
        f"'middle_name': '{self.middle_name}', 'last_name': '{self.last_name}', "
        f"'created_at': {int(self.created_at.timestamp())}, "
        f"'updated_at': {int(self.updated_at.timestamp())}, "
        f"'role': {self.role}, 'is_active': {self.is_active}"
    )
```

---

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è ‚Ññ3: –º–µ—Ç–æ–¥ `to_dict()` —É `CustomUser`

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –≤—ñ–Ω –ø–æ–≤–µ—Ä—Ç–∞—î —Å–∞–º–µ —Ç—ñ –ø–æ–ª—è –≤ —Ç–æ–º—É –ø–æ—Ä—è–¥–∫—É, —è–∫–∏–π –æ—á—ñ–∫—É—î—Ç—å—Å—è:

```python
def to_dict(self):
    return {
        'id': self.id,
        'email': self.email,
        'first_name': self.first_name,
        'middle_name': self.middle_name,
        'last_name': self.last_name,
        'created_at': int(self.created_at.timestamp()),
        'updated_at': int(self.updated_at.timestamp()),
        'role': self.role,
        'is_active': self.is_active,
    }
```

---

## ‚úÖ –ü—ñ—Å–ª—è –≤—Å—ñ—Ö –∑–º—ñ–Ω:

1. –ó—Ä–æ–±–∏ `makemigrations` —Ç–∞ `migrate`, —è–∫—â–æ –∑–º—ñ–Ω—é–≤–∞–≤ –º–æ–¥–µ–ª—å.
2. –ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç–∏ —â–µ —Ä–∞–∑:

```bash
python manage.py test
```

---

–•–æ—á–µ—à ‚Äî —è –º–æ–∂—É –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤–Ω—É –≤–µ—Ä—Å—ñ—é `CustomUser`, —è–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ç–µ—Å—Ç–∏. –ù–∞–ø–∏—Å–∞—Ç–∏?
